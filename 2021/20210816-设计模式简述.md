# 设计模式简述

---

# 何为设计模式

设计模式，设计这里单指的是代码的设计与组织，模式是主体行为的一般方式，是在经过实践之后总结出来的一般套路，具有一般性、简单性、重复性、结构性、稳定性、可操作性的特征。因此设计模式就是代码设计时前人实践出来的各种套路即`最佳实践的集合`。

# 为何学习设计模式

设计模式就与成语一样，是对智慧的浓缩。设计模式现在已经不仅仅是一个术语，而是已经变成了编程领域通用的语言。就如同学习成语一样，学习设计模式是我们接收前人智慧的一种方式，也是我们融入编程文化的一种途径。

设计模式是对虚的设计原则的具体表述。抽象的设计原则需要具体的设计模式来体现，具体的设计模式的提炼需要抽象设计原则的指导，二者相辅相成。设计模式并不局限于 GoF 提出的 23 中设计模式，你也可以在实践中总结自己的模式指导开发。软件开发诞生的时间还太短，虽然它的发展很快，但还有很多空白。设计模式也是一样，23 中看似很多，相对于现实世界的复杂性还是太简单，因此有待于我们去发掘。

# 一句话总结软件设计七大原则

|   设计原则   |                              一句话归纳                              |                    目的                    |
|--------------|----------------------------------------------------------------------|--------------------------------------------|
| 开闭原则     | 对扩展开放，对修改关闭                                               | 降低维护带来的新风险                       |
| 依赖倒置原则 | 高层不应该依赖低层，要面向接口编程                                   | 更利于代码结构的升级扩展                   |
| 单一职责原则 | 一个类只干一件事，实现类要单一                                       | 便于理解，提高代码的可读性                 |
| 接口隔离原则 | 一个接口只干一件事，接口要精简单一                                   | 功能解耦，高聚合、低耦合                   |
| 迪米特法则   | 不该知道的不要知道，一个类应该保持对其它对象最少的了解，降低耦合度   | 只和朋友交流，不和陌生人说话，减少代码臃肿 |
| 里氏替换原则 | 不要破坏继承体系，子类重写方法功能发生改变，不应该影响父类方法的含义 | 防止继承泛滥                               |
| 合成复用原则 | 尽量使用组合或者聚合关系实现代码复用，少使用继承                     | 降低代码耦合                               |

# 概述各个设计模式使用场景

## 创建型模式

### 工厂模式

您需要一辆汽车，可以直接从工厂里面提货，而不用去管这辆汽车是怎么做出来的，以及这个汽车里面的具体实现

### 抽象工厂模式

是围绕一个超级工厂创建其他工厂。该超级工厂又称为其他工厂的工厂

### 单例模式

保证一个类仅有一个实例，并提供一个访问它的全局访问点

### 建造者模式

+	去肯德基，汉堡、可乐、薯条、炸鸡翅等是不变的，而其组合是经常变化的，生成出所谓的"套餐"
+	JAVA 中的 StringBuilder

### 原型模式

+	细胞分裂。 
+	JAVA 中的 Object clone() 方法。

## 结构型模式

### 桥接模式

+	将抽象部分与实现部分分离，使它们都可以独立的变化
+	墙上的开关，可以看到的开关是抽象的，不用管里面具体怎么实现的。
+	猪八戒从天蓬元帅转世投胎到猪，转世投胎的机制将尘世划分为两个等级，即：灵魂和肉体，前者相当于抽象化，后者相当于实现化。生灵通过功能的委派，调用肉体对象的功能，使得生灵可以动态地选择

### 适配器模式

+	美国电器 110V，中国 220V，就要有一个适配器将 110V 转化为 220V。 
+	JAVA JDK 1.1 提供了 Enumeration 接口，而在 1.2 中提供了 Iterator 接口，想要使用 1.2 的 +	JDK，则要将以前系统的 Enumeration 接口转化为 Iterator 接口，这时就需要适配器模式。 
+	在 LINUX 上运行 WINDOWS 程序。 4、JAVA 中的 jdbc。
+	读卡器是作为内存卡和笔记本之间的适配器。您将内存卡插入读卡器，再将读卡器插入笔记本，这样就可以通过笔记本来读取内存卡

### 过滤器模式

允许开发人员使用不同的标准来过滤一组对象，通过逻辑运算以解耦的方式把它们连接起来

### 组合模式（部分整体模式）

+	简单元素的复杂组合可以被看成简单元素
+	算术表达式包括操作数、操作符和另一个操作数，其中，另一个操作数也可以是操作数、操作符和另一个操作数

### 装饰器模式

+	允许向一个现有的对象添加新的功能，同时又不改变其结构
+	动态地给一个对象添加一些额外的职责。就增加功能来说，装饰器模式相比生成子类更为灵活
+	孙悟空有 72 变，当他变成"庙宇"后，他的根本还是一只猴子，但是他又有了庙宇的功能
+	不论一幅画有没有画框都可以挂在墙上，但是通常都是有画框的，并且实际上是画框被挂在墙上。在挂在墙上之前，画可以被蒙上玻璃，装到框子里；这时画、玻璃和画框形成了一个物体

### 外观模式

+	向现有的系统添加一个接口，来隐藏系统的复杂性
+	为子系统中的一组接口提供一个一致的界面，外观模式定义了一个高层接口，这个接口使得这一子系统更加容易使用
+	去医院看病，可能要去挂号、门诊、划价、取药，让患者或患者家属觉得很复杂，如果有提供接待人员，只让接待人员来处理，就很方便。
+	JAVA 的三层开发模式

### 享元模式

+	主要用于减少创建对象的数量，以减少内存占用和提高性能
+	JAVA 中的 String，如果有则返回，如果没有则创建一个字符串保存在字符串缓存池里面。
+	数据库的数据池

### 代理模式

+	一个类代表另一个类的功能
+	为其他对象提供一种代理以控制对这个对象的访问
+	Windows 里面的快捷方式。 
+	买火车票不一定在火车站买，也可以去代售点
+	一张支票或银行存单是账户中资金的代理。支票在市场交易中用来代替现金，并提供对签发人账号上资金的控制
+	spring aop

## 行为型模式

是一种对象行为型模式，它主要解决的问题是：在软件构建过程中，“行为请求者”与“行为实现者”通常呈现一种“紧耦合”的问题

### 责任链模式

+	避免请求发送者与接收者耦合在一起，让多个对象都有可能接收请求，将这些对象连接成一条链，并且沿着这条链传递请求，直到有对象处理它为止
+	红楼梦中的"击鼓传花"。 
+	JS 中的事件冒泡。 
+	JAVA WEB 中 Apache Tomcat 对 Encoding 的处理，Struts2 的拦截器，jsp servlet 的 Filter

### 命令模式

请求以命令的形式包裹在对象中，并传给调用对象。调用对象寻找可以处理该命令的合适的对象，并把该命令传给相应的对象，该对象执行命令

>	策略模式和命令模式的区别在于“是否含有接收者”
>	
>	策略模式是通过不同的算法做同一件事情：例如排序
>	
>	而命令模式则是通过不同的命令做不同的事情，常含有（关联）接收者。
>	
>	[参考](https://www.jianshu.com/p/51408ea09648)

+	命令模式：父母命令孩子吃饭和命令孩子睡觉
	*	即有命令者和被命令者
+	策略模式：小明饿了要填饱肚子
	*	小明可以选择吃米饭来填饱肚子也可以选择吃面包来填饱肚子
	*	目的都是填饱肚子，选择不同的策略
	
### 解释器模式

+	对于一些固定文法构建一个解释句子的解释器。
+	编译器、运算表达式计算

### 迭代器模式

+	提供一种方法顺序访问一个聚合对象中各个元素, 而又无须暴露该对象的内部表示
+	JAVA 中的 iterator

### 中介者模式

+	用一个中介对象来封装一系列的对象交互，中介者使各对象不需要显式地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互
+	多个类相互耦合，形成了网状结构时使用
+	机场调度系统。
+	MVC 框架，其中C（控制器）就是 M（模型）和 V（视图）的中介者

### 备忘录模式

+	保存一个对象的某个状态，以便在适当的时候恢复对象
+	后悔药
+	打游戏时的存档
+	Windows 里的 ctrl + z
+	数据库的事务管理

### 观察者模式

+	当一个对象被修改时，则会自动通知依赖它的对象

### 策略模式

定义一系列的算法,把它们一个个封装起来, 并且使它们可相互替换

### 状态模式

+	类的行为是基于它的状态改变的
+	[策略模式和状态模式的区别](https://www.runoob.com/w3cnote/state-vs-strategy.html)

### 空对象模式

+	一个空对象取代 NULL 对象实例的检查

### 模板模式

+	一个抽象类公开定义了执行它的方法的方式/模板。它的子类可以按需要重写方法实现，但调用将以抽象类中定义的方式进行
+	模板类里面各个方法的执行流程已经被定死了，子类能动的是各个方法具体实现

### 访问者模式

+	不同人可以通过不同方式使用电脑
+	电脑使用的方式
	*	可以通过鼠标操作
	*	可以通过键盘操作
	*	可以通过屏幕看到
	*	可以通过喇叭听到
	*	这里鼠标，键盘，屏幕，喇叭都是一类事物
+	A用户通过鼠标和键盘使用电脑
+	B用户通过键盘和屏幕使用电脑

+	策略模式我们关注的是对于一个类，我们在运行时的不同操作。而访问者模式我们关注的是多个类的情况下，我们访问者访问这些类的时候会有不同的操作。一个是一对多，一个是多对多
	*	策略模式是为了使用电脑，我去网吧或者自己买一台，策略不同，目的是使用电脑，代码里是fucntion里面进行选择
	*	访问者模式是已经有了电脑，我通过什么方式使用，他又通过什么方式使用










